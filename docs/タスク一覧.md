# セカンドフェーズまでの実装チェックリスト

## フェーズ1（ファーストフェーズ）

- [x] Next.js の最新版のインストール
- [x] リポジトリ/環境整備（`.env.example`、scripts、ESLint/Prettier）
- [x] `/app` 骨組み（`layout.tsx`/`page.tsx`/`error.tsx`/`loading.tsx`/`not-found.tsx`）
- [x] RSC/Client 境界設計（エディタは Client、一覧/詳細は RSC）
- [x] zod スキーマ定義（PixelArt/PublishEntry/ImageAsset）
- [x] conform 導入（フォームを zod と接続）
- [x] Prisma 初期化と `schema.prisma` 作成（users/pixel_arts/image_assets/publish_entries）
- [x] 初期マイグレーション適用 + 基本インデックス作成
- [x] Auth.js 設定（プロバイダ/セッション）
- [x] ルート保護と権限（本人のみ編集/削除）
- [x] OpenAI ラッパー（`gpt-image-1`）とエラー処理
- [x] 縮小/ピクセル化の実装（16/32/64、最近傍）
- [x] ストレージ/サムネ戦略（URL 管理を含む）
- [ ] エディタ機能（グリッド/ズーム/ペン/消し/スポイト/塗り/Undo-Redo/パレット）
- [ ] 書き出し機能（PNG コピー/ダウンロード）
- [ ] Server Actions: `createPixelArt`/`updatePixelArt`/`deletePixelArt`/`getMyArts`
- [ ] 主要画面実装（`/`, `/auth/sign-in`, `/generate`, `/editor/:id?`, `/my/arts`, `/art/:id`, `/*`）
- [ ] ローディング/エラー境界の実装
- [ ] レート制限/再試行通知（生成）
- [ ] ログ/メトリクス最小実装（生成・保存イベント）
- [ ] テスト: zod スキーマ/縮小・ピクセル化/Server Actions 基本
- [ ] ドキュメント更新（仕様リンク/運用手順）

## フェーズ2（セカンドフェーズ）

- [ ] 公開スイッチ/非公開切替（Server Action）
- [ ] スラッグ生成・ユニーク制約・本文(Markdown)編集
- [ ] 公開ページ `/p/:slug` 実装
- [ ] ギャラリー `/gallery`（並び替え/ページング）
- [ ] Prisma 拡張: `tags`/`pixel_arts_tags` とマイグレーション
- [ ] タグ正規化ユーティリティ（`input.normalize('NFKC').trim()`、長さ<=32）
- [ ] タグ編集 UI（エディタ/作品詳細、入力補完）
- [ ] タグ保存 Server Action（Upsert + `pixel_arts_tags` 同期）
- [ ] タグ検索（複数 AND、作者/サイズと複合）
- [ ] 公開設定 UI 改善と共有サムネ自動生成
- [ ] 検索条件の URL 同期（クエリ保持）
- [ ] 画像最適化/キャッシュ/CDN 設定（必要に応じて）
- [ ] 監視/メトリクス拡充（公開/タグ操作）
- [ ] セキュリティ整合（zod と DB 制約/公開権限）
- [ ] テスト強化（タグ正規化・検索統合/E2E）
